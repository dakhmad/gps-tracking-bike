<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
  />
  <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    #map {
      height: 100vh;
      width: 100%;
    }
  </style>

  <title>GPS Tracking Sepeda</title>
</head>

<body>
  <div id="map"></div>

  <script>
    // ================= FIREBASE CONFIG =================
    const firebaseConfig = {
      apiKey: "AIzaSyBZlWlk6crlhDU-QqdgfFkVZFjRE41Clbw",
      authDomain: "tracking-gps-bike.firebaseapp.com",
      databaseURL: "https://tracking-gps-bike-default-rtdb.firebaseio.com",
      projectId: "tracking-gps-bike",
      storageBucket: "tracking-gps-bike.firebasestorage.app",
      messagingSenderId: "507860334758",
      appId: "1:507860334758:web:7bf422a0544c8400ca1c67"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ================= MAP INIT =================
    let map = L.map("map").setView([0, 0], 2);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "Â© OpenStreetMap"
    }).addTo(map);

    let marker = L.marker([0, 0]).addTo(map);

    // ================= FIREBASE LISTENER =================
    db.ref("location").on("value", (snapshot) => {
      const data = snapshot.val();
      if (!data) return;

      const lat = data.lat;
      const lng = data.lng;

      marker.setLatLng([lat, lng]);
      map.setView([lat, lng], 18);
    });
  </script>
</body>
</html>
